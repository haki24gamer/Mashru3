{% extends "base.html" %}

{% block title %}{{ project.name }}{% endblock %}

{% block content %}
<div class="container-fluid">
    <h1 class="mt-4">{{ project.name }}</h1>
    <p class="text-muted">
        <i class="fas fa-calendar-alt"></i> {{ project.start_date }} à {{ project.end_date }}
    </p>
    <p>{{ project.description }}</p>

    <ul class="nav nav-tabs" id="projectTabs" role="tablist">
        <li class="nav-item" role="presentation">
            <button class="nav-link active" id="tasks-tab" data-bs-toggle="tab" data-bs-target="#tasks" type="button" role="tab" aria-controls="tasks" aria-selected="true">Tâches</button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="team-tab" data-bs-toggle="tab" data-bs-target="#team" type="button" role="tab" aria-controls="team" aria-selected="false">Équipe</button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="admin-tab" data-bs-toggle="tab" data-bs-target="#admin" type="button" role="tab" aria-controls="admin" aria-selected="false">Administration</button>
        </li>
    </ul>
    <div class="tab-content" id="projectTabsContent">
        {% include 'project_tasks.html' %}
        {% include 'project_team.html' %}
        {% include 'project_admin.html' %}
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Handle Bootstrap 5 tabs properly
        var triggerTabList = [].slice.call(document.querySelectorAll('#projectTabs button'))
        triggerTabList.forEach(function (triggerEl) {
            var tabTrigger = new bootstrap.Tab(triggerEl)
            
            triggerEl.addEventListener('click', function (event) {
                event.preventDefault()
                tabTrigger.show()
            })
        });
        
        // Initialize popovers
        var popoverTriggerList = [].slice.call(document.querySelectorAll('[data-toggle="popover"]'))
        popoverTriggerList.forEach(function (popoverTriggerEl) {
            new bootstrap.Popover(popoverTriggerEl)
        });
        
        // Fix for older Bootstrap data attributes
        $('[data-toggle="modal"]').click(function() {
            var targetModal = $(this).data('target');
            var bsModal = new bootstrap.Modal(document.querySelector(targetModal));
            bsModal.show();
        });
    });
    
    // Convert any other event handlers from project_tasks.html and project_team.html
</script>
{% endblock %}
